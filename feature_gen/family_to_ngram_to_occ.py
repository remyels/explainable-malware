import pandas
import _pickle as cPickle
import pickle

df = pandas.read_csv("trainLabels.csv")

for i in range(3, 10):
	malware_to_features = {}
	for index, row in df.iterrows():
		if row['Class'] == i:
			malware_to_features[row['Id']] = pickle.load(open("malware_ngrams/{}_{}.pickle".format(row['Id'], row['Class']), "rb"))
	p = cPickle.Pickler(open("family_ngrams/ngrams_{}.pickle".format(i), "wb"))
	p.fast = True
	p.dump(malware_to_features)